<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">
<body>
	<ui:composition>

		<p:fieldset legend="#{constantResources.text('criteresrecherche')}">
			<p:panelGrid columns="7" styleClass="panelGridNoBorder">
				
				<p:outputLabel for="dateDebut" value="#{constantResources.text('datedebut')}" />
				<p:calendar id="dateDebut" value="#{controller.dateDebut}"/>
								
				<p:outputLabel for="dateFin" value="#{constantResources.text('datefin')}" />
				<p:calendar id="dateFin" value="#{controller.dateFin}"/>
								
				<p:outputLabel for="natureDep" value="#{constantResources.text('nature')}" />
				<p:selectOneMenu id="natureDep" value="#{controller.natureDeplacement}" converter="#{objectConverter}" >
					<f:selectItem noSelectionOption="" itemLabel="#{constantResources.text('tout')}"/>
					<f:selectItems value="#{natureDeplacements}" var="nd" itemLabel="#{nd.libelle}" />
				</p:selectOneMenu>
								
				<ui:include src="/resources/include/component/formCommand.xhtml" >
					<ui:param name="command" value="#{controller.rechercherCommande}" />
				</ui:include>
				
			</p:panelGrid>
		</p:fieldset>
		
		<p:spacer height="5" />
		
		<p:dataTable id="datatable" value="#{controller.list}" var="dossier" rowIndexVar="index" rowKey="#{index}" selectionMode="multiple" selection="#{controller.selectedMultiple}">
			<p:column selectionMode="multiple" width="1%" rendered="#{controller.isBatchProcessing}"/>
			<p:column headerText="#"><h:outputText value="#{index+1}" /> </p:column>
			<p:column headerText="#{constantResources.text('numero')}" sortBy="#{dossier.numero}" filterBy="#{dossier.numero}">
				<h:outputText value="#{dossier.numero}" />
			</p:column>
			<p:column headerText="#{constantResources.text('datecreation')}" sortBy="#{dossier.deplacement.dateCreation}">
				<h:outputText value="#{dossier.deplacement.dateCreation}"><f:convertDateTime pattern="#{constantResources.datePattern}"/></h:outputText>
			</p:column>
			<p:column headerText="#{constantResources.text('nature')}" sortBy="#{dossier.deplacement.nature.libelle}">
				<h:outputText value="#{dossier.deplacement.nature.libelle}" />
			</p:column>
			<p:column headerText="#{constantResources.text('matricule')}" sortBy="#{dossier.beneficiaire.matricule}" filterBy="#{dossier.beneficiaire.matricule}">
				<h:outputText value="#{dossier.beneficiaire.matricule}" />
			</p:column>
			<p:column headerText="#{constantResources.text('nomprenoms')}" sortBy="#{dossier.beneficiaire.nomPrenoms}" filterBy="#{dossier.beneficiaire.nomPrenoms}">
				<h:outputText value="#{dossier.beneficiaire.nomPrenoms}" />
			</p:column>
		
			<p:column headerText="#{constantResources.text('action')}" rendered="#{controller.showActionsColumn}">
				<p:commandButton value="#{constantResources.text('bouton.details')}" type="button" rendered="#{controller.isBatchProcessing}"/>
				<p:commandButton value="#{constantResources.text('bouton.selectionner')}" action="#{controller.href(dossier)}" immediate="true" process="@this"
					rendered="#{not controller.isBatchProcessing}"/>
			</p:column>
			
		</p:dataTable>
		
	</ui:composition>
</body>
</html>
